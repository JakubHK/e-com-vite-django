{# Partial: cart table with HTMX-enabled update/remove actions #}
{# Context: cart #}
<div class="overflow-hidden rounded-lg border border-gray-200 bg-white">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
      <tr>
        <th class="px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-600">Product</th>
        <th class="px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-gray-600">Unit</th>
        <th class="px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-gray-600">Qty</th>
        <th class="px-4 py-3 text-right text-xs font-semibold uppercase tracking-wide text-gray-600">Subtotal</th>
        <th class="px-4 py-3"></th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-200">
      {% for item in cart.items %}
        <tr>
          <td class="px-4 py-3">
            <a href="{{ item.product.get_absolute_url }}" class="text-sm font-medium text-gray-900 hover:underline">
              {{ item.product.title }}
            </a>
          </td>
          <td class="px-4 py-3 text-right text-sm text-gray-700">
            {{ item.unit_price }} {{ item.currency }}
          </td>
          <td class="px-4 py-3 text-right">
            <form
              hx-post="{% url 'cart_update' %}"
              hx-target="#cart-content"
              hx-swap="innerHTML"
              class="inline-flex items-center gap-2"
            >
              {% csrf_token %}
              <input type="hidden" name="context" value="page" />
              <input type="hidden" name="product_id" value="{{ item.product.id }}">
              <input
                type="number"
                name="qty"
                min="0"
                value="{{ item.qty }}"
                class="w-20 rounded-md ring-1 ring-gray-300 focus:ring-2 focus:ring-indigo-500 px-2 py-1 text-sm"
              />
              <button type="submit" class="inline-flex items-center rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                Update
              </button>
            </form>
          </td>
          <td class="px-4 py-3 text-right text-sm font-medium text-gray-900">
            {{ item.subtotal }} {{ item.currency }}
          </td>
          <td class="px-4 py-3 text-right">
            <form
              hx-post="{% url 'cart_remove' %}"
              hx-target="#cart-content"
              hx-swap="innerHTML"
            >
              {% csrf_token %}
              <input type="hidden" name="context" value="page" />
              <input type="hidden" name="product_id" value="{{ item.product.id }}">
              <button type="submit" class="inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-xs font-medium text-gray-900 hover:bg-gray-50">
                Remove
              </button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>