{% load django_vite %}
<!doctype html>
<html lang="en" class="h-full">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>{% block title %}E-Shop{% endblock %}</title>
  {% block meta_description %}{% endblock %}
  <link rel="canonical" href="{{ request.build_absolute_uri|default:'' }}"/>

  <!-- Open Graph / Twitter -->
  <meta property="og:site_name" content="Eâ€‘Shop"/>
  <meta property="og:title" content="{% block og_title %}E-Shop{% endblock %}"/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="{{ request.build_absolute_uri|default:'' }}"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="{% block twitter_title %}E-Shop{% endblock %}"/>

  {% block head_extra %}{% endblock %}

  <!-- Vite (dev: HMR client; prod: hashed assets via manifest) -->
  {% vite_hmr_client %}
  {% vite_asset 'frontend/style.css' %}
  {% vite_asset 'frontend/main.js' %}

  <meta name="color-scheme" content="light dark" />
</head>
<body class="min-h-screen flex flex-col bg-gray-50 text-gray-900 antialiased">
  <!-- HTMX CSRF header via cookie -->
  <script>
    document.addEventListener('htmx:configRequest', function (evt) {
      function getCookie(name) {
        const match = document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)');
        return match ? match.pop() : '';
      }
      evt.detail.headers['X-CSRFToken'] = getCookie('csrftoken');
    });
  </script>

  {% include "includes/navbar.html" %}

  <main class="flex-1">
    <!-- Flash messages -->
    {% if messages %}
      <div class="container mx-auto max-w-screen-xl px-4 md:px-6 mt-4 space-y-2">
        {% for message in messages %}
          <div class="rounded-md border border-gray-200 bg-white px-4 py-3 text-sm shadow-sm">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <div class="container mx-auto max-w-screen-xl px-4 md:px-6 py-6 md:py-10">
      {% block content %}{% endblock %}
    </div>
  </main>

  {% include "includes/footer.html" %}

  {% block scripts %}{% endblock %}
</body>
</html>